<div id="senaite-sampleheader"
     tal:define="senaite_view python:context.restrictedTraverse('@@senaite_view');
         test nocall:senaite_view/test;
         errors python:request.get('errors', {});
         fields python:view.get_header_fields();"
     i18n:domain="senaite.core">

  <div class="row">
    <div class="col-sm-12">

      <!-- SAMPLE HEADER FORM -->
      <tal:comment condition="python:False">
        <!--
             Note: the `novalidate` attribute is needed to avoid browser validation
             when e.g. the "expected sampling date" has passed and another value
             wants to be changed.

             https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Constraint_validation
        -->
      </tal:comment>
      <form id="senaite-sampleheader-form"
            name="sampleheader_form"
            class="senaite-form"
            method="post" novalidate>

        <!-- Hidden fields -->
        <input type="hidden" name="sampleheader_form_submitted" value="1" />
        <span tal:replace="structure context/@@authenticator/authenticator"/>

        <!-- Prominent fields -->
        <div id="sampleheader-prominent-fields" class="table-responsive">
          <table class="table table-sm mb-0">
            <tr tal:repeat="field python:fields['prominent']">
              <td class="bg-light border-right border-left"
                  style="min-width:200px;width:200px;">
                <!-- Widget Label -->
                <span tal:replace="structure python:view.render_widget_label(field)"></span>
              </td>
              <td class="border-right">
                <!-- Widget Input -->
                <metal:field use-macro="python:view.render_widget(field)"/>
              </td>
            </tr>
          </table>
        </div>

        <!-- Standard fields -->
        <div id="sampleheader-standard-fields" class="table-responsive">
          <table class="table table-sm table-bordered">
            <tr tal:repeat="group python:view.grouper(fields['visible'], 3)">
              <tal:field tal:repeat="field python:group">
                <td class="bg-light text-truncate"
                    style="min-width:200px;width:200px;">
                  <!-- Widget Label -->
                  <span class="text-truncate" tal:replace="structure python:view.render_widget_label(field)"></span>
                </td>
                <td class="">
                  <!-- Widget Input -->
                  <metal:field use-macro="python:view.render_widget(field)"/>
                </td>
              </tal:field>
            </tr>
          </table>
        </div>

        <!-- Save Button -->
        <input tal:condition="view/is_edit_allowed"
               class="btn btn-sm btn-primary mt-2"
               type="submit"
               name="form.button.save"
               value="Save"
               i18n:attributes="value label_save;"/>
      </form>


    </div>
  </div>

  <tal:js tal:define="portal context/@@plone_portal_state/portal;">
    <script type="text/javascript"
            tal:attributes="src python:portal.absolute_url() + '/senaite_widgets/referencewidget.js'"></script>
  </tal:js>
  <tal:css tal:define="portal context/@@plone_portal_state/portal;">
    <style type="text/css" media="screen">
     form[name="sampleheader_form"] select             { width: 220px!important; }
     form[name="sampleheader_form"] input[type="text"] { width: 220px!important; }
     form[name="sampleheader_form"] input[type="date"] { width: 130px!important; }
     form[name="sampleheader_form"] input[type="time"] { width: 90px!important; }
    </style>
  </tal:css>

</div>
