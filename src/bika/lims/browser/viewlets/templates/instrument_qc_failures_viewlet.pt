<div tal:omit-tag=""
     tal:condition="python:view.nr_failed > 0"
     i18n:domain="senaite.core">

  <div class="visualClear"><!-- --></div>

  <script>
    function toggleText(containerId, linkId) {
        var textContainer = document.getElementById(containerId);
        var toggleLink = document.getElementById(linkId);

        if (textContainer.classList.contains("show")) {
            textContainer.classList.add("show");
            toggleLink.querySelector(".more").style.display = "inline";
            toggleLink.querySelector(".less").style.display = "none";
        } else {
            textContainer.classList.remove("show");
            toggleLink.querySelector(".more").style.display = "none";
            toggleLink.querySelector(".less").style.display = "inline";
        }
    }
  </script>

  <div id="portal-alert"
       tal:define="items python:view.failed['out-of-date'];"
       tal:condition="python: len(items) > 0">
    <div class="portlet-alert-item alert alert-warning alert-dismissible" tal:condition="python:len(items) > 0">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <p class="title" tal:condition="python:len(items) == 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instrument's calibration certificate expired:</span>
      </p>
      <p class="title" tal:condition="python:len(items) > 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instruments' calibration certificates expired:</span>
      </p>
      <div tal:condition="python: len(items) <= 5">
        <p tal:content="structure python:', '.join([i['link'] for i in items])"/>
      </div>
      <div tal:condition="python: len(items) > 5">
        <div id="collapseExpiredViewlet" class="collapse">
          <p id="textContainer" tal:content="structure python:', '.join([i['link'] for i in items])"></p>
        </div>
        <a id="toggleLinkExpired" onclick="toggleText('collapseExpiredViewlet', 'toggleLinkExpired')"
        data-toggle="collapse" href="#collapseExpiredViewlet" aria-expanded="false" aria-controls="collapseViewlet">
          <span class="more" i18n:translate="">Show list</span>
          <span class="less" i18n:translate="" style="display: none">Hide list</span>
        </a>
      </div>
    </div>
  </div>

  <div id="portal-alert"
       tal:define="items python:view.failed['qc-fail'];"
       tal:condition="python: len(items) > 0">
    <div class="portlet-alert-item alert alert-warning alert-dismissible" tal:condition="python:len(items) > 0">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <p class="title" tal:condition="python:len(items) == 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instrument disabled until successful calibration:</span>
      </p>
      <p class="title" tal:condition="python:len(items) > 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instruments disabled until successful calibration:</span>
      </p>
      <div tal:condition="python: len(items) <= 5">
        <p tal:content="structure python:', '.join([i['link'] for i in items])"/>
      </div>
      <div tal:condition="python: len(items) > 5">
        <div id="collapseFailedViewlet" class="collapse">
          <p id="textContainer" tal:content="structure python:', '.join([i['link'] for i in items])"></p>
        </div>
        <a id="toggleLinkFailed" onclick="toggleText('collapseFailedViewlet', 'toggleLinkFailed')"
        data-toggle="collapse" href="#collapseFailedViewlet" aria-expanded="false" aria-controls="collapseViewlet">
          <span class="more" i18n:translate="">Show list</span>
          <span class="less" i18n:translate="" style="display: none">Hide list</span>
        </a>
      </div>
    </div>
  </div>

  <div id="portal-alert"
       tal:define="items python:view.failed['next-test'];"
       tal:condition="python: len(items) > 0">
    <div class="portlet-alert-item alert alert-warning alert-dismissible" tal:condition="python:len(items) > 0">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <p class="title" tal:condition="python:len(items) == 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instrument disposed until new calibration tests being done:</span>
      </p>
      <p class="title" tal:condition="python:len(items) > 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instruments disposed until new calibration tests being done:</span>
      </p>
      <div tal:condition="python: len(items) <= 5">
        <p tal:content="structure python:', '.join([i['link'] for i in items])"/>
      </div>
      <div tal:condition="python: len(items) > 5">
        <div id="collapseNextViewlet" class="collapse">
          <p id="textContainer" tal:content="structure python:', '.join([i['link'] for i in items])"></p>
        </div>
        <a id="toggleLinkNext" onclick="toggleText('collapseNextViewlet', 'toggleLinkNext')"
        data-toggle="collapse" href="#collapseNextViewlet" aria-expanded="false" aria-controls="collapseViewlet">
          <span class="more" i18n:translate="">Show list</span>
          <span class="less" i18n:translate="" style="display: none">Hide list</span>
        </a>
      </div>
    </div>
  </div>

  <div id="portal-alert"
       tal:define="items python:view.failed['validation'];"
       tal:condition="python: len(items) > 0">
    <div class="portlet-alert-item alert alert-warning alert-dismissible" tal:condition="python:len(items) > 0">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <p class="title" tal:condition="python:len(items) == 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instrument in validation progress:</span>
      </p>
      <p lass="title" tal:condition="python:len(items) > 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instruments in validation progress:</span>
      </p>
      <div tal:condition="python: len(items) <= 5">
        <p tal:content="structure python:', '.join([i['link'] for i in items])"/>
      </div>
      <div tal:condition="python: len(items) > 5">
        <div id="collapseValidationViewlet" class="collapse">
          <p id="textContainer" tal:content="structure python:', '.join([i['link'] for i in items])"></p>
        </div>
        <a id="toggleLinkValidation" onclick="toggleText('collapseValidationViewlet', 'toggleLinkValidation')"
        data-toggle="collapse" href="#collapseValidationViewlet" aria-expanded="false" aria-controls="collapseViewlet">
          <span class="more" i18n:translate="">Show list</span>
          <span class="less" i18n:translate="" style="display: none">Hide list</span>
        </a>
      </div>
    </div>
  </div>

  <div id="portal-alert"
       tal:define="items python:view.failed['calibration'];"
       tal:condition="python: len(items) > 0">
    <div class="portlet-alert-item alert alert-warning alert-dismissible" tal:condition="python:len(items) > 0">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <p class="title" tal:condition="python:len(items) == 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instrument in calibration progress:</span>
      </p>
      <p class="title" tal:condition="python:len(items) > 1">
        <span tal:content="python:len(items)"/>
        <span i18n:translate="">Instruments in calibration progress:</span>
      </p>
      <div tal:condition="python: len(items) <= 5">
        <p tal:content="structure python:', '.join([i['link'] for i in items])"/>
      </div>
      <div tal:condition="python: len(items) > 5">
        <div id="collapseCalibratingViewlet" class="collapse">
          <p id="textContainer" tal:content="structure python:', '.join([i['link'] for i in items])"></p>
        </div>
        <a id="toggleLinkCalibrating" onclick="toggleText('collapseCalibratingViewlet', 'toggleLinkCalibrating')"
        data-toggle="collapse" href="#collapseCalibratingViewlet" aria-expanded="false" aria-controls="collapseViewlet">
          <span class="more" i18n:translate="">Show list</span>
          <span class="less" i18n:translate="" style="display: none">Hide list</span>
        </a>
      </div>
    </div>
  </div>

</div>
